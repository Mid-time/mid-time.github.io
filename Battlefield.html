<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EoM战斗面板编辑器</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background-color: #1a1a1a;
            color: #e0e0e0;
            margin: 0;
            padding: 20px;
            line-height: 1.5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        .battle-panel {
            background-color: #2a2a2a;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #444;
            margin-bottom: 20px;
            white-space: pre-wrap;
        }
        .editor-panel {
            background-color: #2a2a2a;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #444;
            margin-bottom: 20px;
        }
        .tools-panel {
            background-color: #2a2a2a;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #444;
        }
        .round-line {
            color: #ffcc00;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .team-line {
            margin-bottom: 10px;
        }
        .turn-line {
            color: #4da6ff;
            font-weight: bold;
            margin-top: 10px;
        }
        .editable {
            background-color: #333;
            border: 1px dashed #555;
            padding: 2px 5px;
            min-width: 50px;
            display: inline-block;
        }
        .optional {
            background-color: #333;
            border: 1px dashed #777;
            padding: 2px 5px;
            min-width: 50px;
            display: inline-block;
            color: #aaa;
        }
        button {
            background-color: #4a4a4a;
            color: #e0e0e0;
            border: none;
            padding: 8px 15px;
            margin: 5px;
            border-radius: 3px;
            cursor: pointer;
        }
        button:hover {
            background-color: #5a5a5a;
        }
        .calculator {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 5px;
            margin-top: 10px;
        }
        .calculator-display {
            grid-column: span 4;
            background-color: #333;
            padding: 10px;
            text-align: right;
            font-size: 1.2em;
            margin-bottom: 5px;
        }
        .calculator-btn {
            padding: 10px;
        }
        .span-2 {
            grid-column: span 2;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="battle-panel" id="battle-display">
            <div class="round-line">===== 第<span class="editable" contenteditable="true">1</span>轮 =====</div>
            <div class="team-line"><span class="editable" contenteditable="true">队伍A的内容</span></div>
            <div class="team-line"><span class="editable" contenteditable="true">队伍B的内容</span></div>
            <div class="team-line">[<span class="optional" contenteditable="true">队伍C的内容</span>]</div>
            <div class="team-line">……</div>
            <div class="turn-line">===== <span class="editable" contenteditable="true">角色名</span> 的回合 =====</div>
        </div>

        <div class="editor-panel">
            <button id="add-team-line">添加队伍行</button>
            <button id="add-optional-team">添加可选队伍行</button>
            <button id="copy-display">复制显示内容</button>
        </div>

        <div class="tools-panel">
            <h3>计算器</h3>
            <div class="calculator">
                <div class="calculator-display" id="calc-display">0</div>
                <button class="calculator-btn" onclick="calcInput('7')">7</button>
                <button class="calculator-btn" onclick="calcInput('8')">8</button>
                <button class="calculator-btn" onclick="calcInput('9')">9</button>
                <button class="calculator-btn" onclick="calcOperation('/')">/</button>
                <button class="calculator-btn" onclick="calcInput('4')">4</button>
                <button class="calculator-btn" onclick="calcInput('5')">5</button>
                <button class="calculator-btn" onclick="calcInput('6')">6</button>
                <button class="calculator-btn" onclick="calcOperation('*')">×</button>
                <button class="calculator-btn" onclick="calcInput('1')">1</button>
                <button class="calculator-btn" onclick="calcInput('2')">2</button>
                <button class="calculator-btn" onclick="calcInput('3')">3</button>
                <button class="calculator-btn" onclick="calcOperation('-')">-</button>
                <button class="calculator-btn" onclick="calcInput('0')">0</button>
                <button class="calculator-btn" onclick="calcInput('.')">.</button>
                <button class="calculator-btn" onclick="calculate()">=</button>
                <button class="calculator-btn" onclick="calcOperation('+')">+</button>
                <button class="calculator-btn span-2" onclick="clearCalc()">C</button>
                <button class="calculator-btn span-2" onclick="backspaceCalc()">←</button>
            </div>
        </div>
    </div>

    <script>
        // 添加队伍行
        document.getElementById('add-team-line').addEventListener('click', function() {
            const display = document.getElementById('battle-display');
            const newLine = document.createElement('div');
            newLine.className = 'team-line';
            newLine.innerHTML = '<span class="editable" contenteditable="true">新队伍内容</span>';
            
            // 插入到最后一个非回合行之前
            const turnLine = display.querySelector('.turn-line');
            display.insertBefore(newLine, turnLine);
        });

        // 添加可选队伍行
        document.getElementById('add-optional-team').addEventListener('click', function() {
            const display = document.getElementById('battle-display');
            const newLine = document.createElement('div');
            newLine.className = 'team-line';
            newLine.innerHTML = '[<span class="optional" contenteditable="true">可选队伍内容</span>]';
            
            // 插入到最后一个非回合行之前
            const turnLine = display.querySelector('.turn-line');
            display.insertBefore(newLine, turnLine);
        });

        // 复制显示内容
        document.getElementById('copy-display').addEventListener('click', function() {
            const display = document.getElementById('battle-display');
            const textToCopy = display.innerText.replace(/\n\n/g, '\n'); // 移除多余空行
            
            navigator.clipboard.writeText(textToCopy).then(function() {
                alert('内容已复制到剪贴板！');
            }, function() {
                // 如果剪贴板API不可用，使用备用方法
                const textarea = document.createElement('textarea');
                textarea.value = textToCopy;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                alert('内容已复制到剪贴板！');
            });
        });

        // 计算器功能
        let currentInput = '0';
        let previousInput = '';
        let operation = null;
        let resetInput = false;

        function updateDisplay() {
            document.getElementById('calc-display').textContent = currentInput;
        }

        function calcInput(num) {
            if (currentInput === '0' || resetInput) {
                currentInput = num;
                resetInput = false;
            } else {
                currentInput += num;
            }
            updateDisplay();
        }

        function calcOperation(op) {
            if (operation !== null) calculate();
            previousInput = currentInput;
            operation = op;
            resetInput = true;
        }

        function calculate() {
            let result;
            const prev = parseFloat(previousInput);
            const current = parseFloat(currentInput);
            
            if (isNaN(prev) || isNaN(current)) return;
            
            switch (operation) {
                case '+':
                    result = prev + current;
                    break;
                case '-':
                    result = prev - current;
                    break;
                case '*':
                    result = prev * current;
                    break;
                case '/':
                    result = prev / current;
                    break;
                default:
                    return;
            }
            
            currentInput = result.toString();
            operation = null;
            resetInput = true;
            updateDisplay();
        }

        function clearCalc() {
            currentInput = '0';
            previousInput = '';
            operation = null;
            updateDisplay();
        }

        function backspaceCalc() {
            if (currentInput.length === 1) {
                currentInput = '0';
            } else {
                currentInput = currentInput.slice(0, -1);
            }
            updateDisplay();
        }

        // 初始化显示
        updateDisplay();
    </script>
</body>
</html>
  